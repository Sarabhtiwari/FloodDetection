services:
  - type: web
    name: flood-detection
    env: python
    branch: main
    buildCommand: |
      # install python deps later via pip (Render runs buildCommand before start); install node & build frontend
      cd frontend
      npm ci
      npm run build
      # move frontend build into backend static folder
      rm -rf ../backend/static
      mkdir -p ../backend/static
      cp -r dist/* ../backend/static/
      cd ..
      pip install -r requirements.txt
    startCommand: gunicorn -k eventlet -w 1 backend.app:app
    plan: free